---
# A scenario describes some aspect of building a model, most models would have only one scenario

# Scenarios could also go into documentation as examples of how the model is built...

# Theses tests would create data in a warehouse and would therefore never be run in a production
# environment.  They would only be run in a CI environment with fake data.

scenario:
  description: Building mytarget
  model: mytarget

  # Maybe include background data common to all cases here....

  # A scenario is a collection of cases, each case describes a variation on an input
  # and the expected output.
  cases:

    - description: Date ranges are exploded to day-level granularity
      given:
        - name: mysource # could be a source or a model/ref
          data: |
            | student_id | start_at   | end_at     | value |
            | -          | -          | -          | -     |
            | 1          | 2019-01-01 | 2019-01-03 | A     |
            | 1          | 2019-01-04 | 2019-01-05 | B     |

      expected:
        identifier: 'student_id = 1'
        data: |
          | student_id | day        | value |
          | -          | -          | -     |
          | 1          | 2019-01-01 | A     |
          | 1          | 2019-01-02 | A     |
          | 1          | 2019-01-03 | A     |
          | 1          | 2019-01-04 | B     |
          | 1          | 2019-01-05 | B     |

    - description: Missing ranges are filled in with the previous value
      given:
        - name: mysource
          data: |
            | student_id | start_at   | end_at     | value |
            | -          | -          | -          | -     |
            | 2          | 2019-01-01 | 2019-01-01 | A     |
            | 2          | 2019-01-04 | 2019-01-05 | B     |

      expected:
        identifier: 'student_id = 2'
        data: |
          | student_id | day        | value |
          | -          | -          | -     |
          | 2          | 2019-01-01 | A     |
          | 2          | 2019-01-02 | A     |
          | 2          | 2019-01-03 | A     |
          | 2          | 2019-01-04 | B     |
          | 2          | 2019-01-05 | B     |
